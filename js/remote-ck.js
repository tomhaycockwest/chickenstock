// load in csv file
// var prices = "http://staging.chickenstockapp.com/test.csv";
function loadPrices(){$.ajax({url:"test.csv",async:!1,success:function(e){csv_as_array=$.csv.toArrays(e)},dataType:"text"})}function isANumber(e){return isNaN(e)==0?e:0}var csv_as_array=[];loadPrices();$(document).ready(function(){function o(n){var r=0,i="",s=e;switch(s){case"b1150g":fresh=3;frozen=20;break;case"b1150g1350g":fresh=4;frozen=21;break;case"b1350g1550g":fresh=5;frozen=22;break;case"b1550g2050g":fresh=6;frozen=23;break;case"r2050g2450g":fresh=7;frozen=24;break;case"r2450g":fresh=8;frozen=25;break;case"breast":fresh=9;frozen=26;break;case"725kg":fresh=12;frozen=29;break;case"725kg9kg":fresh=13;frozen=30;break;case"9kg":fresh=14;frozen=31;break;case"ducklingWeight":fresh=16;frozen=33;break;case"gooseWeight":fresh=18;frozen=35;break;default:}var o=$.map(csv_as_array,function(t){return t[r]}),u=$.map(csv_as_array,function(t){return isANumber(t[fresh])}),a=$.map(csv_as_array,function(t){return isANumber(t[frozen])}),f=[],l=[],c=0,h=52,p=new Array(h);for(var d=0;d<p.length;d++)p[d]=new Array(h);for(d=0;d<o.length;d++){var v=o[d],m=parseInt(u[d],10),g=parseInt(a[d],10);f.push(m);var y=v.split("-").join(" ");l.push(y);var b="20"+v.substr(v.length-2);if(b==n)if(t=="fresh"){p[c][0]=y.substr(0,y.length-2)+"12";p[c][1]=m;c++}else{p[c][0]=y.substr(0,y.length-2)+"12";p[c][1]=g;c++}else console.log("no year")}console.log(p);return p}function a(){var e=o("2012"),t=o("2013"),n=o("2014");f&&f.destroy();f=$.jqplot("graph",[n,t,e],{animate:!0,textColor:"#42454f",gridPadding:{right:35},legend:{show:!0},grid:{backgroundColor:"#28292c",gridLineColor:"#40444d",borderColor:"#28292c",shadow:!1},axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer,tickOptions:{formatString:"%b"},min:"Jan, 2012",tickInterval:"1 month"}},highlighter:{show:!0,sizeAdjust:10},series:u})}function l(){u=[{label:r,color:"#bf4423",shadow:!1},{label:i,color:"#fd881b",shadow:!1},{label:s,color:"#ff0",shadow:!1}];t="fresh";console.log(t)}function c(){u=[{label:r,color:"#0c5888",shadow:!1},{label:i,color:"#0084d8",shadow:!1},{label:s,color:"#ff0",shadow:!1}];t="frozen";console.log(t)}var e="b1150g",t="fresh",n=new Date,r=n.getFullYear(),i=n.getFullYear()-1,s=n.getFullYear()-2;$(".dropdown-menu li").click(function(t){e=t.target.id;console.log(e);a()});$("#fresh").click(function(){l();a()});$("#frozen").click(function(){c();a()});$("#chickenGraph").click(function(){$("#chickenDropdown span").html("Broilers &lt; 1,150g");$("#chickenDropdown").addClass("active-dropdown").siblings(".dropdown").removeClass("active-dropdown");e="b1150g";a()});$("#turkeyGraph").click(function(){$("#turkeyDropdown span").html("&lt; 7.25kg");$("#turkeyDropdown").addClass("active-dropdown").siblings(".dropdown").removeClass("active-dropdown");e="725kg";a()});$("#ducklingGraph").click(function(){$("#ducklingDropdown").addClass("active-dropdown").siblings(".dropdown").removeClass("active-dropdown");e="ducklingWeight";a()});$("#gooseGraph").click(function(){$("#gooseDropdown").addClass("active-dropdown").siblings(".dropdown").removeClass("active-dropdown");e="gooseWeight";a()});var u=[{label:"2013",color:"#bf4423",shadow:!1},{label:"2012",color:"#fd881b",shadow:!1}],f;l();a()});